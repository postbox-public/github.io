/*! Copyright (c) 2020 Postbox, Inc. */
var bb=function(){"use strict";var e={};return e.init=function(){e.jsDetect.addClass(),e.svgDetect.addClass(),e.svgDetect.svgToPng(),e.timedHero.init(),e.scrollTransitions.init(),e.mobileNav.attach(".page-head .hamburger",".page-head","active"),e.nav.init(".page-head",{checkerClass:"page-head--overlay",topClass:"is-top",notTopClass:"is-not-top"}),e.headroom.init(),e.alertBanner.init()},e}();bb.alertBanner=function(){"use strict";var e={};return e.init=function(){const e=$("#alert-banner");void 0==Cookies.get("showAlert")||"true"==Cookies.get("showAlert")?$("#alert-banner button").click(function(){e.fadeOut("fast",function(){Cookies.remove("showAlert",{path:"/"}),Cookies.set("showAlert","false",{path:"/",expires:1})})}):e.fadeOut("fast")},e}(),function(e){e.fn.animatedModal=function(t){function n(){l.css({"z-index":i.zIndexOut}),i.afterClose()}function a(){i.afterOpen()}var o=e(this),i=e.extend({modalTarget:"animatedModal",position:"fixed",width:"100%",height:"100%",top:"0px",left:"0px",zIndexIn:"9999",zIndexOut:"-9999",color:"#39BEB9",opacityIn:"1",opacityOut:"0",animatedIn:"zoomIn",animatedOut:"zoomOut",animationDuration:".6s",overflow:"auto",beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){}},t),r=e(".close-"+i.modalTarget),s=e(o).attr("href"),l=e("body").find("#"+i.modalTarget),c="#"+l.attr("id");l.addClass("animated"),l.addClass(i.modalTarget+"-off");var u={position:i.position,width:i.width,height:i.height,top:i.top,left:i.left,"background-color":i.color,"overflow-y":i.overflow,"z-index":i.zIndexOut,opacity:i.opacityOut,"-webkit-animation-duration":i.animationDuration,"-moz-animation-duration":i.animationDuration,"-ms-animation-duration":i.animationDuration,"animation-duration":i.animationDuration};l.css(u),o.click(function(t){t.preventDefault(),e("body, html").css({overflow:"hidden"}),s==c&&(l.hasClass(i.modalTarget+"-off")&&(l.removeClass(i.animatedOut),l.removeClass(i.modalTarget+"-off"),l.addClass(i.modalTarget+"-on")),l.hasClass(i.modalTarget+"-on")&&(i.beforeOpen(),l.css({opacity:i.opacityIn,"z-index":i.zIndexIn}),l.addClass(i.animatedIn),l.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",a)))}),r.click(function(t){t.preventDefault(),e("body, html").css({overflow:"auto"}),i.beforeClose(),l.hasClass(i.modalTarget+"-on")&&(l.removeClass(i.modalTarget+"-on"),l.addClass(i.modalTarget+"-off")),l.hasClass(i.modalTarget+"-off")&&(l.removeClass(i.animatedIn),l.addClass(i.animatedOut),l.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",n))})}}(jQuery),bb.example=function(){"use strict";var e={};return e.publicMethod=function(){},e}(),bb.headroom=function(){"use strict";var e={offset:300,tolerance:5,onUnpin:function(){var e=$(".page-head"),t=$(".page-nav__list");e.hasClass("active")&&t.slideUp("200",function(){e.removeClass("active"),t.show()})}},t=document.querySelector(".page-head"),n=new Headroom(t,e);return n}(),bb.mobileNav=function(){"use strict";var e={},t=function(t){e.to.toggleClass(e.toggle)};return e.attach=function(n,a,o){e.on=$(n),e.to=$(a),e.toggle=o,e.on.on("click",t)},e}(),bb.nav=function(){"use strict";var e,t,n={},a=function(){$(window).scrollTop()>0?(e.removeClass(t.topClass),e.addClass(t.notTopClass)):(e.removeClass(t.notTopClass),e.addClass(t.topClass))};return n.init=function(n,o){e=$(n),t=o,e.hasClass(t.checkerClass)?(e.addClass(t.topClass),e.addClass(t.topClass),$(window).scroll(a)):$("body").addClass("page-head-push")},n}(),bb.payments=function(){"use strict";var e={vatCheckUrl:"",baseTaxRate:0,basePrices:{USD:10,GBP:7,EUR:10},basePricesWithoutDiscount:{USD:10,GBP:7,EUR:10},volumePrices:{USD:{},GBP:{},EUR:{}},volumePricesWithoutDiscount:{USD:{},GBP:{},EUR:{}},formats:{USD:"$%cost%",GBP:"£%cost%",EUR:"%cost% €"},methods:{},braintree:{},discount_string:null,discount_code:null,priceChanges$:new Rx.BehaviorSubject};return e.init=function(t,n,a,o){e.baseTaxRate=parseFloat(a.baseTax),e.rates=t,e.vatCheckUrl=a.vat_check_url,e.discount_code=a.discount_code,e.discount_string=a.pricing_data.discount_string,Object.keys(a.pricing_data.prices).forEach(function(t){var n=a.pricing_data.prices[t];e.basePrices[t]=parseInt(n.base_price)/100;var o={};n.volume_pricing&&Object.keys(n.volume_pricing).forEach(function(e){o[e]=parseInt(n.volume_pricing[e])/100}),e.volumePrices[t]=o,e.formats[t]=n.format_string}),Object.keys(a.base_prices).forEach(function(t){var n=a.base_prices[t];e.basePricesWithoutDiscount[t]=parseInt(n.base_price)/100;var o={};n.volume_pricing&&Object.keys(n.volume_pricing).forEach(function(e){o[e]=parseInt(n.volume_pricing[e])/100}),e.volumePricesWithoutDiscount[t]=o});var i=o.method,r=e.methods[i];r.init(n,o),bb.payments.form.attach(n,r,a),r.postForm&&r.postForm(e)},e}(),bb.scrollTransitions=function(){"use strict";var e={};return e.init=function(){$('main[role="main"] > section:not(.no-transition):not(.product-statement__section)').attr("data-aos","fade-up").attr("data-aos-anchor-placement","top-bottom").attr("data-aos-offset","170");var e={duration:600,once:!0};AOS.init(e),$(window).on("load",function(){AOS.refresh()})},e}(),jQuery(function(e){e("#testimonial-carousel").slick({dots:!0,draggable:!1,fade:!0,appendDots:e("#dots"),arrows:!1,autoplay:!0,autoplaySpeed:8e3,customPaging:function(t,n){return e('<a href="javascript:void(0)" data-role="none" role="button" tabindex="0" class="slider-dot" />').html("&nbsp;")}});var t=null;$carousel=e("#testimonial-carousel"),$carousel.on("beforeChange",function(t,n,a){var o=n.$slides[a];e("img, div.overlay-text",o).show(),e("iframe",o).remove(),e(".vimeo-video-container",o).data("vimeo-initialized",!1).removeAttr("data-vimeo-initialized"),$carousel.slick("slickPlay")});var n=function(){$carousel.slick("slickNext");var t=$carousel.slick("slickCurrentSlide"),n=$carousel.slick("getSlick"),a=n.$slides[t];e(".play-button",a).click()};e("#testimonial-carousel .play-button").click(function(){var a=e(this).parents(".video-item");e("img, div.overlay-text",a).hide();var o=(a.children(".vimeo-video-container").attr("id"),a.attr("vimeo")),i=e('<iframe src="https://player.vimeo.com/video/'+o+'?autoplay=1&title=0&byline=0&portrait=0" width="100%" height="100%" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>').css({width:"100%",height:a.parents(".slick-track").height(),display:"block"});i.appendTo(a.children(".vimeo-video-container")),$carousel.slick("slickPause"),t=new Vimeo.Player(i),t.on("ended",function(){setTimeout(n,2e3)})})}),bb.smoothScroll=function(){"use strict";var e={};return e.toHref=function(e){$("html, body").animate({scrollTop:$(window).height()},500)},e}(),bb.stickyNav=function(){"use strict";var e={},t=!1,n=!1,a=null,o=function(){n=!1,a&&(clearInterval(a),a=null);var o=window.pageYOffset>e.attachOffset.height();o!==t&&(t=o,o?(e.to.removeClass(e.normal),e.to.addClass(e.attached)):(e.to.removeClass(e.attached),e.to.addClass(e.normal)))},i=function(e){o()},r=function(e){n||(a&&clearInterval(a),a=setTimeout(o,250))};return e.attach=function(t,n,a,o){e.attachOffset=o,e.to=$(t),e.normal=n,e.attached=a,$(window).scroll(i),$(window).resize(r)},e}(),bb.timedHero=function(){"use strict";var e={};return e.init=function(){var e=(new Date).getHours(),t=e>=6&&e<=18,n=document.querySelector(".hero--skyline");n&&(n.style.backgroundImage="url(/assets/images/hero/postbox-hero-"+(t?"day":"night")+".svg")},e}(),jQuery(function(){if($("#video-container").length>0){$("#video-container").vide({mp4:"https://postbox-video.s3.amazonaws.com/Postbox%20Looper-2000.mp4",ogv:"https://s3.amazonaws.com/postbox-video/Postbox_Hero_Looper.ogv",webm:"https://s3.amazonaws.com/postbox-video/Postbox_Hero_Looper.webm",poster:"/assets/images/poster-image.png",posterType:"png"},{className:"hero-video"});var e=$("#video-container").data("vide"),t=e.getVideoObject(),n=$("#iframe-template").html(),a=null;$("#watch-vimeo-video").animatedModal({modalTarget:"hero-vimeo-video",animatedIn:"bounceInUp",animatedOut:"bounceOutDown",color:"#000000",afterOpen:function(){t.pause();var e=$(n);e.appendTo($("#iframe-holder")),a=new Vimeo.Player(e),a.on("ended",function(){setTimeout(function(){$(".close-hero-vimeo-video").click()},500)})},beforeClose:function(){t.play(),$("#iframe-holder").empty()}})}}),bb.payments.methods.braintree=function(){var e={client:null,form:null,options:{},tokens:[],integration:null},t=null;return e.init=function(n,a){e.form=n,e.options=a,e.tokens=a.tokens,e.tokenizer=null,e.getNonce=null;var o=null,i=$("select[name=country]",n).val(),r=bb.payments.euChecker.getCurrency(i),s=e.tokens[r.toLowerCase()],l=new Rx.Subject,c={};$.each([bb.payments.braintree.cc,bb.payments.braintree.paypal].filter(function(e){return"undefined"==typeof e.supports||e.supports()}),function(e,t){name=t.key,t.init(n,a);var o=$("<li />").addClass("braintree-payment-method-"+name),i=$('<input type="radio" name="braintree_method" value="'+name+'"/>');$label=$("<label />").append(i).append(t.displayName),o.append($label),$("#payment-options").append(o),c[name]={radio:i,listItem:o,label:$label,medium:t}}),$(":input[name=braintree_method]").change(function(){var t=$(this).val();$("#method-form",n).empty(),$(":input[name=braintree_method]",n).attr("disabled","disabled");var a=c[t].medium;l.onNext(!0);var i=function(){return e.integration&&e.integration.teardown?e.integration.teardown():Promise.resolve(!0)};i().then(function(){a.createIntegration(s,bb.payments.form).then(function(t){e.integration=t,bb.payments.priceChanges$.takeUntil(l).subscribe(function(t){t.token=e.tokens[t.currency.toLowerCase()],e.integration.onPriceChange(t)}),$(":input[name=braintree_method]",n).removeAttr("disabled")})["catch"](function(){$(":input[name=braintree_method]",n).removeAttr("disabled")}),o=a})}),$(":input[name=braintree_method][value="+(a.default_method?a.default_method:"cc")+"]",n).attr("checked","checked").change(),$("input[name=payment_provider]",t).val("braintree")},e.onSubmit=function(t){if(!e.integration)throw new Error("Please select payment.");return nonce=e.integration.onSubmit(),new Promise.resolve(nonce)},e.postForm=function(e){$.each(bb.payments.braintree,function(t,n){n.postForm&&n.postForm(e)})},e}(),bb.payments.calculator=function(){"use strict";var e={};return e.getTaxRate=function(e){return bb.payments.euChecker.isEU(e)&&void 0!==bb.payments.rates[e]?bb.payments.rates[e]:bb.payments.baseTaxRate},e.getTaxName=function(e){return"US"===e?"Tax":"VAT"},e.getTax=function(t,n){var a=e.getTaxRate(n);return t*a},e}(),bb.payments.euChecker=function(){"use strict";var e={};return e.isEU=function(e){return bb.payments.rates.hasOwnProperty(e)},e.getCurrency=function(t){return"GB"===t?"GBP":e.isEU(t)?"EUR":"USD"},e}(),bb.payments.form=function(){"use strict";var e,t={},n=function(){var e=$(this),n=parseInt(e.val());n<=0&&e.val(1),t.calc()},a=function(e){t.calc();var n=t.$form;bb.payments.euChecker.isEU(e)?$("#vat_number-container",n).show():$("#vat_number-container",n).hide()},o=!1,i=!1,r=function(e){$("#feedback-overall").html(e).show(),window.scrollTo(0,$("#feedback-overall").scrollTop())};t.generalError='Something went wrong with your transaction. Please try again, select a different payment method, or contact the <a href="mailto:store@postbox-inc.com">Postbox Store</a> for assistance.',t.displayError=r,t.setPaymentToken=function(e){var n=t.$form,a=$("input[name=token]",n);0==a.length?$('<input name="token" type="hidden" />').val(e).appendTo(n):a.val(e)},t.attach=function(a,s,l){t.$form=a,e=a,t.country=l.country||"US",i=$("#vat-selected").val(),o="1"==i,o=!1,$(".eu-vat-mode-link").click(function(){o?t.disableVATMode():t.enableVATMode()}),e.find("#amount").on("change",n),$(".eu-vat-mode-link").text($(".eu-vat-mode-link").data("us-mode-text")),o&&t.enableVATMode(),$(":input",e).on("invalid",function(t){var n=$(this),a=$(":invalid",e).first();if(n[0]===a[0]){var o=$("#page-head").height()+60,i=n.offset().top-o,r=$(window).scrollTop()-o;i>r&&i<window.innerHeight+r||$(window).scrollTop(i)}}),t.calc();var c=function(e){"locked"==$(e.target).data("lock")?e.preventDefault():$(e.target).data("lock","locked")},u=$("#complete-btn",e),d=u.val(),m=function(n){return n.preventDefault(),u.prop("disabled",!0).attr("disabled","disabled"),u.val("Processing Your Purchase..."),s.onSubmit(e,n).then(function(n){t.setPaymentToken(n),e.unbind("submit",m),e.bind("submit",c),e.get(0).submit()}).caught(function(e){e&&"string"==typeof e&&e.length&&r(e),u.prop("disabled",!1).removeAttr("disabled"),u.val("object"==typeof e&&e.buttonValue?e.buttonValue:d)}),!1};e.bind("submit",m)};var s=function(e,t){var n=bb.payments.vatCheckUrl.indexOf("?")==-1,a=null;return new Promise(function(o,i){a=$.getJSON(bb.payments.vatCheckUrl+(n?"?":"&")+"country="+t+"&vat_number="+e,function(e){o(e.valid_vat)}).fail(function(e){o(e)})}).cancellable().caught(Promise.CancellationError,function(){a.abort()})},l=null;t.calc=function(){var e=t.$form,n=parseInt(e.find("#amount").val());isNaN(n)&&(n=1,e.find("#amount").val(1));for(var a=$("#country",e),o=a.length?a.val():"US",i=bb.payments.euChecker.getCurrency(o),r=bb.payments.calculator.getTaxName(o),u=bb.payments.calculator.getTaxRate(o),d=bb.payments.basePrices[i],m=bb.payments.basePricesWithoutDiscount[i],f=bb.payments.volumePrices[i],p=bb.payments.volumePricesWithoutDiscount[i],v=bb.payments.discount_code,b=bb.payments.discount_string,h=Object.keys(f),g=0,y=0;y<h.length;y++){var C=parseInt(h[y]);C>n||(g=g>C?g:C)}g>0&&(d=f[g]),Object.keys(p).forEach(function(e){n>=e&&(m=p[e])});var w=d*n,x=bb.payments.calculator.getTax(w,o);$('[data-rate-name="true"]').text(r),$('[data-rate="true"]').text(100*u+"%");var _=$(":input[name=vat_number]",t.$form),k=_.length?_.val():"";_.parents(".form--vat-error, .form--vat-success").removeClass("form--vat-error form--vat-success"),_.siblings(".form__message").remove();var P=function(){bb.payments.priceChanges$.onNext({currency:i,singleCost:d,baseCost:w,tax:0,discountCode:v,discountString:b,originalCost:m,totalCost:w}),c(i,d,w,0,v,b,m),_.parents(".form__group").addClass("form--vat-success"),_.siblings(".form__message").remove()},T=function(){bb.payments.priceChanges$.onNext({currency:i,singleCost:d,baseCost:w,tax:x,discountCode:v,discountString:b,originalCost:m,totalCost:w+x}),_.parents(".form__group").addClass("form--vat-error"),0==_.siblings(".form__message").length&&_.after('<span class="form__message vat-validation"><span class="vat-indicator"></span> The VAT number is invalid.</span>')},S=function(){bb.payments.priceChanges$.onNext({currency:i,singleCost:d,baseCost:w,tax:x,discountCode:v,discountString:b,originalCost:m,totalCost:w+x}),_.parents(".form__group").addClass("form--vat-error"),0==_.siblings(".form__message").length&&_.after('<span class="form__message vat-validation"><span class="vat-indicator"></span> VAT verification service cannot be reached, please try again later.</span>')};k.trim().length&&(null!=l&&l.cancel(),l=s(k,o).then(function(e){l=null,e?P():T()}).caught(Promise.CancellationError,function(e){}).caught(function(e){400==e.status?T():S()})),bb.payments.priceChanges$.onNext({currency:i,singleCost:d,baseCost:w,tax:x,discountCode:v,discountString:b,originalCost:m,totalCost:w+x}),c(i,d,w,x,v,b,m)};var c=function(e,t,n,a,o,i,r){a=a?a:0,$('[data-tax="true"]').text(bb.payments.formats[e].replace("%cost%",a.toFixed(2))),$('[data-single-price="true"]').text(bb.payments.formats[e].replace("%cost%",r.toFixed(2))),$('[data-base-price="true"]').text(bb.payments.formats[e].replace("%cost%",n.toFixed(2))),$('[data-price="true"]').text(bb.payments.formats[e].replace("%cost%",(a+n).toFixed(2))),0===a?($('[data-rate-name="true"],[data-rate="true"],[data-tax="true"],[data-if-tax="true"]').hide(),$('[data-if-tax="false"]').show()):($('[data-rate-name="true"],[data-rate="true"],[data-tax="true"],[data-if-tax="true"]').show(),$('[data-if-tax="false"]').hide()),o&&t!==r?($(".discount-string").show(),$("[data-discounted-price=true]").text(bb.payments.formats[e].replace("%cost%",t.toFixed(2))),$("[data-single-price=true]").css({textDecoration:"line-through"})):($(".discount-string").hide(),$("[data-discounted-price=true]").empty(),$("[data-single-price=true]").css({textDecoration:"none"}))};return t.enableVATMode=function(){o=!0;var n=$("#template-vat-mode").html();$("#vat-mode").html(n),e.find("#country").on("change",function(e){a($(this).val())}).change(),e.find(":input[name=vat_number]").on("change",t.calc),$(".eu-vat-mode-link").text($(".eu-vat-mode-link").data("eu-mode-text")),$("#vat-selected").val("1")},t.disableVATMode=function(){o=!1,$("#vat-mode").empty(),$("[data-avs-extras]",e).remove(),a("US"),$(".eu-vat-mode-link").text($(".eu-vat-mode-link").data("us-mode-text")),$("#vat-selected").val("0")},window.enableVATMode=t.enableVATMode,window.disableVATMode=t.disableVATMode,t}(),bb.payments.methods.stripe=function(){var e={},t=null;e.init=function(){};var n=function(e,n){return function(a,o){o.error?n(o.error.message):(t.append($('<input type="hidden" name="token">').val(o.id)),t.get(0).submit(),e(!0))}};e.onSubmit=function(e){return t=e,new Promise(function(e,a){t.find(":submit").prop("disabled",!0),Stripe.card.createToken({name:t.find("#customer_name").val(),number:t.find('[data-stripe="number"]').val(),cvc:t.find('[data-stripe="cvc"]').val(),exp_month:t.find('[data-stripe="exp-month"]').val(),exp_year:t.find('[data-stripe="exp-year"]').val()},n(e,a))})}}();var links=document.querySelectorAll("a");Array.prototype.forEach.call(links,function(e){link_href=e.getAttribute("href"),void 0!=link_href&&link_href.startsWith("https://vimeo.com")&&e.setAttribute("data-lity","")}),!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],function(n){return t(e,n)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=t(e,require("jquery")):e.lity=t(e,e.jQuery||e.Zepto)}("undefined"!=typeof window?window:this,function(e,t){"use strict";function n(e){var t=_();return O&&e.length?(e.one(O,t.resolve),setTimeout(t.resolve,500)):t.resolve(),t.promise()}function a(e,n,a){if(1===arguments.length)return t.extend({},e);if("string"==typeof n){if(void 0===a)return void 0===e[n]?null:e[n];e[n]=a}else t.extend(e,n);return this}function o(e){var t=e.indexOf("?");t>-1&&(e=e.substr(t+1));for(var n,a=decodeURI(e.split("#")[0]).split("&"),o={},i=0,r=a.length;i<r;i++)a[i]&&(n=a[i].split("="),o[n[0]]=n[1]);return o}function i(e,n){if(!n)return e;if("string"===t.type(n)&&(n=o(n)),e.indexOf("?")>-1){var a=e.split("?");e=a.shift(),n=t.extend({},o(a[0]),n)}return e+"?"+t.param(n)}function r(e,t){var n=e.indexOf("#");return-1===n?t:(n>0&&(e=e.substr(n)),t+e)}function s(e,t,n,a){return t&&t.element().addClass("lity-iframe"),n&&(e=i(e,n)),a&&(e=r(a,e)),'<div class="lity-iframe-container"><iframe frameborder="0" allowfullscreen src="'+e+'"/></div>'}function l(e){return t('<span class="lity-error"/>').append(e)}function c(e,n){var a=n.opener()&&n.opener().data("lity-desc")||"Image with no description",o=t('<img src="'+e+'" alt="'+a+'"/>'),i=_(),r=function(){i.reject(l("Failed loading image"))};return o.on("load",function(){return 0===this.naturalWidth?r():void i.resolve(o)}).on("error",r),i.promise()}function u(e,n){var a,o,i;try{a=t(e)}catch(e){return!1}return!!a.length&&(o=t('<i style="display:none !important"/>'),i=a.hasClass("lity-hide"),n.element().one("lity:remove",function(){o.before(a).remove(),i&&!a.closest(".lity-content").length&&a.addClass("lity-hide")}),a.removeClass("lity-hide").after(o))}function d(e,t){return s(e,t)}function m(){return w.documentElement.clientHeight?w.documentElement.clientHeight:Math.round(x.height())}function f(e){var t=g();t&&(27===e.keyCode&&t.options("esc")&&t.close(),9===e.keyCode&&p(e,t))}function p(e,t){var n=t.element().find(E),a=n.index(w.activeElement);e.shiftKey&&a<=0?(n.get(n.length-1).focus(),e.preventDefault()):e.shiftKey||a!==n.length-1||(n.get(0).focus(),e.preventDefault())}function v(){t.each(P,function(e,t){t.resize()})}function b(e){1===P.unshift(e)&&(k.addClass("lity-active"),x.on({resize:v,keydown:f})),t("body > *").not(e.element()).addClass("lity-hidden").each(function(){var e=t(this);void 0===e.data(S)&&e.data(S,e.attr(T)||null)}).attr(T,"true")}function h(e){var n;e.element().attr(T,"true"),1===P.length&&(k.removeClass("lity-active"),x.off({resize:v,keydown:f})),P=t.grep(P,function(t){return e!==t}),n=P.length?P[0].element():t(".lity-hidden"),n.removeClass("lity-hidden").each(function(){var e=t(this),n=e.data(S);n?e.attr(T,n):e.removeAttr(T),e.removeData(S)})}function g(){return 0===P.length?null:P[0]}function y(e,n,a,o){var i,r="inline",s=t.extend({},a);return o&&s[o]?(i=s[o](e,n),r=o):(t.each(["inline","iframe"],function(e,t){delete s[t],s[t]=a[t]}),t.each(s,function(t,a){return!a||!(!a.test||a.test(e,n))||(i=a(e,n),!1!==i?(r=t,!1):void 0)})),{handler:r,content:i||""}}function $(e,o,i,r){function s(e){u=t(e).css("max-height",m()+"px"),c.find(".lity-loader").each(function(){var e=t(this);n(e).always(function(){e.remove()})}),c.removeClass("lity-loading").find(".lity-content").empty().append(u),f=!0,u.trigger("lity:ready",[d])}var l,c,u,d=this,f=!1,p=!1;o=t.extend({},D,o),c=t(o.template),d.element=function(){return c},d.opener=function(){return i},d.content=function(){return u},d.options=t.proxy(a,d,o),d.handlers=t.proxy(a,d,o.handlers),d.resize=function(){f&&!p&&u.css("max-height",m()+"px").trigger("lity:resize",[d])},d.close=function(){if(f&&!p){p=!0,h(d);var e=_();if(r&&(w.activeElement===c[0]||t.contains(c[0],w.activeElement)))try{r.focus()}catch(e){}return u.trigger("lity:close",[d]),c.removeClass("lity-opened").addClass("lity-closed"),n(u.add(c)).always(function(){u.trigger("lity:remove",[d]),c.remove(),c=void 0,e.resolve()}),e.promise()}},l=y(e,d,o.handlers,o.handler),c.attr(T,"false").addClass("lity-loading lity-opened lity-"+l.handler).appendTo("body").focus().on("click","[data-lity-close]",function(e){t(e.target).is("[data-lity-close]")&&d.close()}).trigger("lity:open",[d]),b(d),t.when(l.content).always(s)}function C(e,n,a){e.preventDefault?(e.preventDefault(),a=t(this),e=a.data("lity-target")||a.attr("href")||a.attr("src")):a=t(a);var o=new $(e,t.extend({},a.data("lity-options")||a.data("lity"),n),a,w.activeElement);if(!e.preventDefault)return o}var w=e.document,x=t(e),_=t.Deferred,k=t("html"),P=[],T="aria-hidden",S="lity-"+T,E='a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])',D={esc:!0,handler:null,handlers:{image:c,inline:u,iframe:d},template:'<div class="lity" role="dialog" aria-label="Dialog Window (Press escape to close)" tabindex="-1"><div class="lity-wrap" data-lity-close role="document"><div class="lity-loader" aria-hidden="true">Loading...</div><div class="lity-container"><div class="lity-content"></div><button class="lity-close" type="button" aria-label="Close (Press escape to close)" data-lity-close>&times;</button></div></div></div>'},A=/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i,O=function(){var e=w.createElement("div"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return t[n];return!1}();return c.test=function(e){return A.test(e)},C.version="3.0.0-dev",C.options=t.proxy(a,C,D),C.handlers=t.proxy(a,C,D.handlers),C.current=g,C.iframe=s,t(w).on("click.lity","[data-lity]",C),C}),function(e,t){"function"==typeof define&&define.amd?define(["lity"],function(e){t(e)}):t("object"==typeof module&&"object"==typeof module.exports?require("lity"):e.lity)}("undefined"!=typeof window?window:this,function(e){"use strict";var t=/(vimeo(pro)?\.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/;e.handlers("vimeo",function(n,a){var o=t.exec(n);return!!o&&e.iframe("https://player.vimeo.com/video/"+o[3]+"?autoplay=1",a,o[4],n)})}),bb.payments.braintree.coinbase=function(){var e,t={displayName:"",coinbase:null,key:"bitcoin",supports:function(){return!bowser.msie}},n=null,a=null,o=!1;t.init=function(e){n=e};var i=function(e){return o=!1,new Promise(function(t){var i=new Promise(function(r,s){$("#method-form").html($("#template-coinbase").html()),braintree.setup(e.token,"custom",{coinbase:{container:"coinbase-container",enableBillingAddress:!0,amount:(e.tax+e.baseCost).toFixed(2),currency:e.currency,singleUse:!0},onReady:function(e){$("#complete-btn").removeAttr("disabled"),t({integration:e,onSubmit:i})},onPaymentMethodReceived:function(e){o=!0,a=e.nonce,0===$.trim($("input[name=customer_email]",n).val()).length&&$("input[name=customer_email]",n).val(e.details.email),$("input[name=payment_medium]",n).val("bitcoin"),r(a)},onAuthorizationDismissed:function(){o=!1,$("iframe#braintree-coinbase-frame").addClass("centered"),s("dismissed")},onCancelled:function(){console.log("HERE"),o=!1,$("iframe#braintree-coinbase-frame").addClass("centered"),s("cancelled")}})})})},r=function(e){return new Promise(function(e,t){var n=new Promise(function(t,a){e({integration:null,onSubmit:n}),$("#method-form").html("<em>Bitcoin payments only apply to USD purchases only.</em>"),$("#complete-btn").attr("disabled","disabled"),t("")})})},s=function(e,t){return $("#complete-btn").val("Complete Purchase"),Promise.resolve(t).then(function(e){return!e||new Promise(function(t){e.teardown(function(){o=!1,$("#method-form").empty(),t()})})}).then(function(){return"USD"===e.currency?i(e):r(e)})};return t.createIntegration=function(e,n){var a=null,i=0;return function(){return bb.payments.form.setPaymentToken(""),Promise.resolve({onSubmit:function(){return o?Promise.resolve(t.coinbase.onSubmit):Promise.reject("Please complete the Coinbase payment authorization first.")},teardown:function(){return $("#complete-btn").removeAttr("disabled"),t.coinbase&&t.coinbase.integration?new Promise(function(e){t.coinbase.integration.teardown(),t.coinbase=null,e()}):Promise.resolve(!0)},onPriceChange:function(e){e.currency===a&&e.totalCost===i||(a=e.currency,i=e.totalCost,s(e,t.coinbase&&t.coinbase.integration?t.coinbase.integration:null).then(function(e){t.coinbase=e}))}})}()},t.postForm=function(){e=bb.payments.form.priceChange$},t}(),bb.payments.braintree.cc=function(){var e={displayName:"",key:"cc"},t=null,n=null,a={},o=!1;e.init=function(e,t){n=e,a=t,o=!1,"cc"==a.default_method?("authorization"!=a.error_on_step&&"charge"!=a.error_on_step&&$("[data-avs-extras]",n).remove(),400==a.error_code&&bb.payments.form.displayError(bb.payments.form.generalError)):$("[data-avs-extras]",n).remove()},e.postForm=function(){};var i=function(e,t){return function(n,a){n?t(bb.payments.form.generalError):e(a)}},r=function(){return new Promise(function(e,a){var o=[{sel:$("#card_number"),msg:"The card number field is required."},{sel:$("#card_cvc"),msg:"The CVC number is required."}];o.forEach(function(e){e.sel.parents(".form__group").removeClass("form--error"),e.sel.siblings("span.form__message").remove()});var r=o.filter(function(e){return 0==$.trim(e.sel.val()).length});if(r.forEach(function(e){var t=e.sel,n=t.parents(".form__group");n.addClass("form--error"),t.after('<span class="form__message">'+e.msg+"</span>")}),r.length>0)return void a(null);var s={number:$('[data-braintree-name="card_number"]',n).val(),cvv:$('[data-braintree-name="cvv"]',n).val(),expirationMonth:$('[data-braintree-name="expiration_month"]',n).val(),expirationYear:$('[data-braintree-name="expiration_year"]',n).val(),cardholderName:$('[data-braintree-name="cardholder_name"]',n).val(),billingAddress:{}};$("input[name=postal_code]",n).length&&(s.billingAddress.postalCode=$("input[name=postal_code]",n).val()),t.tokenizeCard(s,i(e,a))})};return e.onPriceChange=function(e){t=new braintree.api.Client({clientToken:e.token})},e.createIntegration=function(e,n){return $("#complete-btn").val("Complete Purchase"),function(e,n){t=new braintree.api.Client({clientToken:e}),$(":input[name=payment_medium]").val("cc");var o=$("#method-form");if(0===$.trim(o.html()).length){var i=$("#template-cc").html();o.html(i)}return("cc"!==a.default_method||"charge"!==a.error_on_step&&"authorization"!==a.error_on_step)&&$("[data-avs-extras]",n).remove(),Promise.resolve({onSubmit:function(){return r()},teardown:function(){return Promise.resolve(!0)},onPriceChange:function(e){}})}(e,n)},e}(),bb.payments.braintree.paypal=function(){var e,t={id:"paypal",displayName:"",paypal:null,key:"paypal"},n=null,a=null;t.init=function(e){n=e};var o=function(e,t){return Promise.resolve(t).then(function(e){return!e||new Promise(function(t){e.teardown(t)})}).then(function(){return new Promise(function(t){var o=new Promise(function(i,r){braintree.setup(e.token,"paypal",{container:"paypal-container",headless:!0,enableBillingAddress:!0,amount:(e.tax+e.baseCost).toFixed(2),currency:e.currency,singleUse:!0,onReady:function(e){e.onSubmit=o,t(e)},onPaymentMethodReceived:function(e){a=e.nonce,$("#braintree-paypal-loggedin").css({maxWidth:"inherit"});var t=$("input[name=customer_name]",n);0===$.trim(t.val()).length&&t.val([e.details.firstName,e.details.lastName].filter(function(e){return e&&e.length>0}).join(" ")),$("input[name=customer_name], input[name=license_name], input[name=customer_email]",n).filter(function(){return $.trim($(this).val()).length>0}).each(function(){$(this).parents(".form--error").removeClass("form--error"),$(this).siblings(".form__message").remove()}),$("input[name=payment_medium]").val("paypal"),i(a)},onAuthorizationDismissed:function(){r("dismissed")},onCancelled:function(){r("cancelled")}})})})})};return t.createIntegration=function(e,n){return function(e,n){return bb.payments.form.setPaymentToken(""),$("#method-form").html($("#template-paypal").html()),$("#complete-btn").val("Pay with PayPal"),Promise.resolve({onSubmit:function(){if(!t.paypal)throw new Error("Please try again.");return t.paypal.paypal.initAuthFlow(),t.paypal.onSubmit.then(function(e){return $("#complete-btn").val("Processing Your Purchase..."),e}).caught(function(e){throw"dismissed"===e||"cancelled"===e?{buttonValue:"Pay with PayPal"}:e})},teardown:function(){return t.paypal?new Promise(function(e){t.paypal.teardown(function(){t.paypal=null,e()})}):Promise.resolve(!0)},onPriceChange:function(e){o(e,t.paypal).then(function(e){t.paypal=e})}})}()},t.postForm=function(){e=bb.payments.form.priceChange$},t}(),bb.jsDetect=function(){var e={},t=document.documentElement;return e.addClass=function(){t.className=t.className.replace("no-js","js")},e}(),bb.svgDetect=function(){"use strict";var e={},t=document.documentElement;return e.isSupported=function(){return!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")},e.addClass=function(){e.isSupported?t.className+=" svg":t.className+=" no-svg"},e.svgToPng=function(){if(!e.isSupported)for(var t=document.getElementsByTagName("img"),n=/.*\.svg$/i,a=0;a!==t.length;++a)t[a].src.match(n)&&(t[a].src=t[a].src.slice(0,-3)+"png")},e}();